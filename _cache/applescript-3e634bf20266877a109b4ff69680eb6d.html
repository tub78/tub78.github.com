<div class="highlight"><pre><code class="applescript">  <span class="cm">(*</span>
<span class="cm">  Purpose: Use this script to re-open using &quot;MacVim&quot; a document that is open in</span>
<span class="cm">  &quot;Safari&quot;.  The script detects the full path of the local file and re-opens it.</span>
<span class="cm">  Ideally, the script would also close the file in &quot;Safari&quot;, but this has not</span>
<span class="cm">  been implemented.  </span>

<span class="cm">  Usage: This script should be run from the applescript menu when the document is</span>
<span class="cm">  open-and-frontmost in Safari.</span>

<span class="cm">  Installation: Place the script in ~/Library/Scripts/Applications/Safari/  To</span>
<span class="cm">  access this script, make sure to select &quot;Show script menu in menu bar&quot; in the</span>
<span class="cm">  AppleScript Utility application (10.5) or in Preferences &amp;gt; General of the</span>
<span class="cm">  AppleScript Editor application (10.6).</span>

<span class="cm">  Installation for mouse and trackpad-free access:  Choose a keyboard shortcut</span>
<span class="cm">  that will &quot;Move focus to status menus in the menu bar&quot;.  This can be set up in</span>
<span class="cm">  the &quot;Keyboard &amp; Mouse&quot; System Preferences.</span>

<span class="cm">  Author: Stuart J. D. Andrews;</span>
<span class="cm">  Email: sunny day in nyc at gmail com</span>
<span class="cm">  Date: April 15, 2011</span>
<span class="cm">  Environment: Script Editor 2.3; AppleScript 2.1.2; Mac OS X 10.6.7</span>

<span class="cm">  *)</span>

  <span class="k">property</span> <span class="nv">myapp</span> <span class="p">:</span> <span class="s2">&quot;Safari&quot;</span>
  <span class="k">property</span> <span class="nv">debug</span> <span class="p">:</span> <span class="no">false</span>
  <span class="c">-- property debug : true</span>

  <span class="k">try</span>
    <span class="k">set</span> <span class="nv">front_process</span> <span class="k">to</span> <span class="nb">application</span> <span class="s2">&quot;Finder&quot;</span>
    <span class="c">--</span>
    <span class="k">tell</span> <span class="nb">application</span> <span class="s2">&quot;Safari&quot;</span>
      <span class="k">set</span> <span class="nv">VVV</span> <span class="k">to</span> <span class="nv">URL</span> <span class="k">of</span> <span class="na">document</span> <span class="mi">1</span>
    <span class="k">end</span> <span class="k">tell</span>

    <span class="c">-- remove leading &quot;file://&quot;</span>
    <span class="nb">do shell script</span> <span class="s2">&quot;echo &quot;</span> <span class="o">&amp;</span> <span class="nb">quoted form</span> <span class="k">of</span> <span class="nv">VVV</span> <span class="o">&amp;</span> <span class="s2">&quot;| cut -c 8-&quot;</span>
    <span class="k">set</span> <span class="nv">VVV</span> <span class="k">to</span> <span class="no">result</span>
    <span class="nv">errmsg</span><span class="p">(</span><span class="nv">VVV</span><span class="p">,</span> <span class="nv">front_process</span><span class="p">)</span>

    <span class="c">-- open file in Skim</span>
    <span class="k">tell</span> <span class="nb">application</span> <span class="s2">&quot;MacVim&quot;</span>
      <span class="nb">activate</span>
      <span class="nb">open</span> <span class="nv">VVV</span>
    <span class="k">end</span> <span class="k">tell</span>


  <span class="nb">on</span> <span class="k">error</span> <span class="nb">the</span> <span class="nv">error_message</span> <span class="nv">number</span> <span class="nb">the</span> <span class="nv">error_number</span>
    <span class="nv">errmsg</span><span class="p">(</span><span class="s2">&quot;Error: &quot;</span> <span class="o">&amp;</span> <span class="nb">the</span> <span class="nv">error_number</span> <span class="o">&amp;</span> <span class="s2">&quot;. &quot;</span> <span class="o">&amp;</span> <span class="nb">the</span> <span class="nv">error_message</span><span class="p">,</span> <span class="nv">front_process</span><span class="p">)</span>

  <span class="k">end</span> <span class="k">try</span>


  <span class="nb">on</span> <span class="nv">errmsg</span><span class="p">(</span><span class="nv">VVV</span><span class="p">,</span> <span class="nv">active_process</span><span class="p">)</span>
    <span class="k">if</span> <span class="nv">debug</span> <span class="k">then</span>
      <span class="k">tell</span> <span class="nv">active_process</span>
        <span class="nb">activate</span>
        <span class="nb">display dialog</span> <span class="s2">&quot;Value: &quot;</span> <span class="o">&amp;</span> <span class="nv">VVV</span> <span class="nb">buttons</span> <span class="p">{</span><span class="s2">&quot;OK&quot;</span><span class="p">}</span> <span class="nv">default</span> <span class="nb">button</span> <span class="mi">1</span>
      <span class="k">end</span> <span class="k">tell</span>
    <span class="k">end</span> <span class="k">if</span>
  <span class="k">end</span> <span class="nv">errmsg</span>
</code></pre>
</div>
