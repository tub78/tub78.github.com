<div class="highlight"><pre><code class="applescript">  <span class="cm">(*</span>
<span class="cm">  Purpose: Tells Safari to &quot;Reopen All Windows From Last Session&quot;.</span>

<span class="cm">  Usage: Save this script as an application, and add it to your &quot;Login Items&quot;</span>

<span class="cm">  In order to use this script, you will need to &quot;Enable access for assistive</span>
<span class="cm">  devices&quot;.  Please read the following instructions from</span>
<span class="cm">  [dougscripts.com](http://dougscripts.com/itunes/itinfo/keycodes.php)</span>

<span class="cm">  &gt; Setting Up System Preferences</span>
<span class="cm">  &gt;</span>
<span class="cm">  &gt; In order for the &quot;System Events&quot; application to use the key code or keystroke</span>
<span class="cm">  &gt; commands, you have to enable Mac OS X&#39;s accessibility frameworks. To do this,</span>
<span class="cm">  &gt; click on the &quot;Universal Access&quot; pane in &quot;System Preferences&quot;. At the bottom of</span>
<span class="cm">  &gt; the pane is a checkbox setting called &quot;Enable access for assistive devices&quot;.</span>
<span class="cm">  &gt; Click on the checkbox so the setting is enabled. Close out of System</span>
<span class="cm">  &gt; Preferences.</span>

<span class="cm">  Author: Stuart J. D. Andrews;</span>
<span class="cm">  Email: sunny day in nyc at gmail com</span>
<span class="cm">  Date: March 6, 2011</span>
<span class="cm">  Environment: Script Editor 2.3; AppleScript 2.1.2; Mac OS X 10.6.7</span>
<span class="cm">  *)</span>

  <span class="nv">do_menu</span><span class="p">(</span><span class="s2">&quot;Safari&quot;</span><span class="p">,</span> <span class="s2">&quot;History&quot;</span><span class="p">,</span> <span class="s2">&quot;Reopen All Windows from Last Session&quot;</span><span class="p">)</span>

  <span class="nb">on</span> <span class="nv">do_menu</span><span class="p">(</span><span class="nv">app_name</span><span class="p">,</span> <span class="nv">menu_name</span><span class="p">,</span> <span class="nv">menu_item</span><span class="p">)</span>
    <span class="k">try</span>
      <span class="c">-- bring the target application to the front</span>
      <span class="k">tell</span> <span class="nb">application</span> <span class="nv">app_name</span>
        <span class="nb">activate</span>
      <span class="k">end</span> <span class="k">tell</span>
      <span class="k">tell</span> <span class="nb">application</span> <span class="s2">&quot;System Events&quot;</span>
        <span class="k">tell</span> <span class="nv">process</span> <span class="nv">app_name</span>
          <span class="k">tell</span> <span class="na">menu</span> <span class="nv">bar</span> <span class="mi">1</span>
            <span class="k">tell</span> <span class="na">menu</span> <span class="nv">bar</span> <span class="nb">item</span> <span class="nv">menu_name</span>
              <span class="k">tell</span> <span class="na">menu</span> <span class="nv">menu_name</span>
                <span class="nv">click</span> <span class="na">menu</span> <span class="nb">item</span> <span class="nv">menu_item</span>
              <span class="k">end</span> <span class="k">tell</span>
            <span class="k">end</span> <span class="k">tell</span>
          <span class="k">end</span> <span class="k">tell</span>
        <span class="k">end</span> <span class="k">tell</span>
      <span class="k">end</span> <span class="k">tell</span>
      <span class="no">return</span> <span class="no">true</span>
    <span class="nb">on</span> <span class="k">error</span> <span class="nv">error_message</span>
      <span class="no">return</span> <span class="no">false</span>
    <span class="k">end</span> <span class="k">try</span>
  <span class="k">end</span> <span class="nv">do_menu</span>
</code></pre>
</div>
